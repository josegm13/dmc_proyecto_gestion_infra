name: CI/CD Pipeline

on:
  push:
    branches: ["main"]
  pull_request:
    branches: ["main"]

jobs:
  #  Job 1: Integraci贸n Continua (CI)
  build-and-test:
    name: Integraci贸n Continua
    runs-on: ubuntu-latest

    steps:
      - name: Clonar el repositorio
        uses: actions/checkout@v4

      - name: Configurar Node.js
        uses: actions/setup-node@v4
        with:
          node-version: "20"

      - name: Instalar dependencias
        run: npm install

      - name: Ejecutar pruebas
        run: npm test

  #  Job 2: Despliegue Continuo (CD)
  deploy:
    name: Despliegue Continuo
    runs-on: ubuntu-latest
    needs: build-and-test  # Solo se ejecuta si el CI pasa correctamente

    if: github.ref == 'refs/heads/main'  # Solo se ejecuta en la rama main

    steps:
      - name: Clonar el repositorio
        uses: actions/checkout@v4

      - name: Desplegar aplicaci贸n
        run: |
          echo "Desplegando aplicaci贸n..."
          # Aqu铆 ir铆an tus comandos reales de despliegue, por ejemplo:
          # scp -r ./dist usuario@servidor:/var/www/app
          # ssh usuario@servidor "systemctl restart nginx"
